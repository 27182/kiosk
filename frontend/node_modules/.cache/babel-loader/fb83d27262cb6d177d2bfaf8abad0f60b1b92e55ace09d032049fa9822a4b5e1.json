{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-782dac6a\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"wrapper\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"loading-progress\"\n};\nimport { onMounted } from 'vue';\nimport axios from 'axios';\nimport { ref } from \"vue\";\nimport MenuListBody from '@/components/MenuListBody.vue';\nimport MenuListFooter from '@/components/MenuListFooter.vue';\nimport { useRouter } from 'vue-router';\nconst __default__ = {\n  name: 'GuestMenuView',\n  props: {}\n};\nexport default /*#__PURE__*/Object.assign(__default__, {\n  setup(__props) {\n    let myData = ref([]);\n    let isLoading = ref(true);\n    let myCart = ref([]);\n    let isWaitingtoPay = ref(false);\n    let base64_image = ref({});\n    async function getData() {\n      await axios.get(\"/api/menu/list\").then(d => {\n        myData.value = d.data;\n        for (let item of myData.value) {\n          axios.get(\"/api/menu_img/\" + item.imgurl).then(a => {\n            if (a.status !== 404) {\n              base64_image.value[item.mno] = a;\n            }\n          }).catch(() => {});\n        }\n      });\n    }\n    const router = useRouter();\n    function gotoPay() {\n      isWaitingtoPay.value = true;\n      let content = {};\n      let totalPrice = 0;\n      let cartState = myCart.value.map(i => {\n        let a = i.get('menu').mname;\n        let b = i.get('amount');\n        let c = i.get('menu').price * b;\n        content[a] = b.toString() + \"개\";\n        totalPrice += c;\n        return [a, b, c];\n      });\n      const data = {\n        'content': JSON.stringify(content).replace(/['\"]+/g, ''),\n        'totalPrice': totalPrice\n      };\n      axios.post('/api/order', data).then(res => {\n        if (res.data.isSuccess) {\n          setTimeout(() => {\n            isWaitingtoPay.value = false;\n            router.push({\n              path: '/result',\n              name: 'result',\n              state: {\n                ono: res.data.ono,\n                myCart: cartState\n              }\n            });\n          }, 1000);\n        } else {\n          alert('오류: 주문 접수 실패');\n          isWaitingtoPay.value = false;\n        }\n      });\n    }\n    function addMenutoCart(i, amount) {\n      let map = new Map();\n      map.set('menu', i);\n      map.set('amount', amount);\n      myCart.value.push(map);\n    }\n    onMounted(() => {\n      getData().then(() => {\n        console.log(myData.value);\n        isLoading.value = false;\n      });\n    });\n    function deletefromCart(i) {\n      myCart.value.splice(i, 1);\n    }\n    return (_ctx, _cache) => {\n      const _component_v_progress_circular = _resolveComponent(\"v-progress-circular\");\n      const _component_v_card = _resolveComponent(\"v-card\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", null, [_unref(isWaitingtoPay) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createVNode(_component_v_progress_circular, {\n        size: 74,\n        width: 8,\n        indeterminate: \"\"\n      })])) : _createCommentVNode(\"\", true), _createVNode(_component_v_card, {\n        variant: \"flat\"\n      }, {\n        default: _withCtx(() => [_createVNode(MenuListBody, {\n          base64_image: _unref(base64_image),\n          isLoading: _unref(isLoading),\n          myData: _unref(myData),\n          onAddToCart: addMenutoCart\n        }, null, 8, [\"base64_image\", \"isLoading\", \"myData\"]), _createVNode(MenuListFooter, {\n          onGoToPay: gotoPay,\n          onDeleteFromCart: deletefromCart,\n          myCart: _unref(myCart)\n        }, null, 8, [\"myCart\"])]),\n        _: 1\n      })])]);\n    };\n  }\n});","map":{"version":3,"names":["onMounted","axios","ref","MenuListBody","MenuListFooter","useRouter","__default__","name","props","myData","isLoading","myCart","isWaitingtoPay","base64_image","getData","get","then","d","value","data","item","imgurl","a","status","mno","catch","router","gotoPay","content","totalPrice","cartState","map","i","mname","b","c","price","toString","JSON","stringify","replace","post","res","isSuccess","setTimeout","push","path","state","ono","alert","addMenutoCart","amount","Map","set","console","log","deletefromCart","splice"],"sources":["C:/Users/201-14/Desktop/temp/새 폴더/my/frontend/src/views/GuestMenuView.vue"],"sourcesContent":["<template>\r\n  <div class=\"wrapper\">\r\n    <div>\r\n      <div class=\"loading-progress\" v-if=\"isWaitingtoPay\">\r\n        <v-progress-circular :size=\"74\" :width=\"8\" indeterminate></v-progress-circular>\r\n      </div>\r\n      <v-card variant=\"flat\">\r\n        <MenuListBody :base64_image=\"base64_image\" :isLoading=\"isLoading\" :myData=\"myData\" @add-to-cart=\"addMenutoCart\"></MenuListBody>\r\n        <MenuListFooter @go-to-pay=\"gotoPay\" @delete-from-cart=\"deletefromCart\" :myCart=\"myCart\"></MenuListFooter>\r\n      </v-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted } from 'vue';\r\nimport axios from 'axios';\r\nimport { ref } from \"vue\";\r\nimport MenuListBody from '@/components/MenuListBody.vue'\r\nimport MenuListFooter from '@/components/MenuListFooter.vue'\r\nimport { useRouter } from 'vue-router';\r\n\r\n\r\nlet myData = ref([]);\r\nlet isLoading = ref(true);\r\nlet myCart = ref([]);\r\nlet isWaitingtoPay = ref(false);\r\n\r\nlet base64_image = ref({});\r\nasync function getData() {\r\n  await axios.get(\"/api/menu/list\").then((d) => {\r\n    myData.value = d.data;\r\n\r\n    for(let item of myData.value) {\r\n      axios.get(\"/api/menu_img/\" + item.imgurl).then((a) => {\r\n        if (a.status !== 404){\r\n          base64_image.value[item.mno] = a;\r\n        }\r\n      }).catch(() => { });\r\n    }\r\n  })\r\n}\r\nconst router = useRouter();\r\n\r\nfunction gotoPay() {\r\n  isWaitingtoPay.value = true;\r\n  let content = {};\r\n  let totalPrice = 0;\r\n  let cartState = myCart.value.map(i => {\r\n    let a = i.get('menu').mname;\r\n    let b = i.get('amount');\r\n    let c = i.get('menu').price * b;\r\n    content[a] = b.toString() + \"개\";\r\n    totalPrice += c;\r\n    return [a, b, c];\r\n  });\r\n\r\n\r\n  const data = {\r\n    'content': JSON.stringify(content).replace(/['\"]+/g, ''),\r\n    'totalPrice': totalPrice,\r\n  }\r\n\r\n\r\n\r\n  axios.post('/api/order', data\r\n\r\n  ).then((res) => {\r\n    if (res.data.isSuccess) {\r\n      setTimeout(() => {\r\n        isWaitingtoPay.value = false;\r\n        router.push({\r\n          path: '/result', name: 'result', state: {\r\n            ono: res.data.ono,\r\n            myCart: cartState,\r\n          }\r\n        });\r\n      }, 1000\r\n      );\r\n    } else {\r\n      alert('오류: 주문 접수 실패');\r\n      isWaitingtoPay.value = false;\r\n    }\r\n\r\n  })\r\n}\r\n\r\n\r\nfunction addMenutoCart(i, amount) {\r\n  let map = new Map();\r\n  map.set('menu', i);\r\n  map.set('amount', amount);\r\n  myCart.value.push(map);\r\n}\r\n\r\nonMounted(() => {\r\n  getData().then(()=>{\r\n    console.log(myData.value)\r\n    isLoading.value = false;\r\n\r\n  })\r\n\r\n});\r\n\r\n\r\nfunction deletefromCart(i) {\r\n  myCart.value.splice(i, 1);\r\n}\r\n\r\n\r\n\r\n</script>\r\n\r\n<script>\r\nexport default {\r\n  name: 'GuestMenuView',\r\n  props: {\r\n\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n.loading-progress {\r\n  position: absolute;\r\n  z-index: 1;\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 768px;\r\n  /* top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%); */\r\n\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}