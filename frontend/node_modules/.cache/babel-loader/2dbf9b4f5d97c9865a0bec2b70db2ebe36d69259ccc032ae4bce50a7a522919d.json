{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { onMounted } from 'vue';\nimport axios from 'axios';\nimport { ref } from \"vue\";\nimport MenuListBody from '@/components/MenuListBody.vue';\nimport MenuListFooter from '@/components/MenuListFooter.vue';\nimport { useRouter } from 'vue-router';\nconst __default__ = {\n  name: 'GuestMenuView',\n  props: {}\n};\nexport default /*#__PURE__*/Object.assign(__default__, {\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    let myData = ref([]);\n    let isLoading = ref(true);\n    let myCart = ref([]);\n    let isWaitingtoPay = ref(false);\n    let imgsrc = ref({});\n    async function getData() {\n      await axios.get(\"/api/menu/list\").then(d => {\n        myData.value = d.data;\n      });\n    }\n    const router = useRouter();\n    function gotoPay() {\n      isWaitingtoPay.value = true;\n      let content = {};\n      let totalPrice = 0;\n      let cartState = myCart.value.map(i => {\n        let a = i.get('menu').mname;\n        let b = i.get('amount');\n        let c = i.get('menu').price * b;\n        content[a] = b.toString() + \"개\";\n        totalPrice += c;\n        return [a, b, c];\n      });\n      const data = {\n        'content': JSON.stringify(content).replace(/['\"]+/g, ''),\n        'totalPrice': totalPrice\n      };\n      axios.post('/api/order', data).then(res => {\n        if (res.data.isSuccess) {\n          setTimeout(() => {\n            isWaitingtoPay.value = false;\n            router.push({\n              path: '/result',\n              name: 'result',\n              state: {\n                ono: res.data.ono,\n                myCart: cartState\n              }\n            });\n          }, 1000);\n        } else {\n          alert('오류: 주문 접수 실패');\n          isWaitingtoPay.value = false;\n        }\n      });\n    }\n    function addMenutoCart(i, amount) {\n      let map = new Map();\n      map.set('menu', i);\n      map.set('amount', amount);\n      myCart.value.push(map);\n    }\n    onMounted(async () => {\n      await getData().then(async () => {\n        for (let item of myData.value) {\n          await axios.get(\"/api/menu_img/\" + item.imgurl, {\n            responseType: 'blob'\n          }).then(a => {\n            let url = URL.createObjectURL(a.data);\n            imgsrc.value[item.mno] = url;\n          });\n        }\n      });\n      isLoading.value = false;\n    });\n    function deletefromCart(i) {\n      myCart.value.splice(i, 1);\n    }\n    const __returned__ = {\n      get myData() {\n        return myData;\n      },\n      set myData(v) {\n        myData = v;\n      },\n      get isLoading() {\n        return isLoading;\n      },\n      set isLoading(v) {\n        isLoading = v;\n      },\n      get myCart() {\n        return myCart;\n      },\n      set myCart(v) {\n        myCart = v;\n      },\n      get isWaitingtoPay() {\n        return isWaitingtoPay;\n      },\n      set isWaitingtoPay(v) {\n        isWaitingtoPay = v;\n      },\n      get imgsrc() {\n        return imgsrc;\n      },\n      set imgsrc(v) {\n        imgsrc = v;\n      },\n      getData,\n      router,\n      gotoPay,\n      addMenutoCart,\n      deletefromCart,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      ref,\n      MenuListBody,\n      MenuListFooter,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n});","map":{"version":3,"names":["onMounted","axios","ref","MenuListBody","MenuListFooter","useRouter","__default__","name","props","myData","isLoading","myCart","isWaitingtoPay","imgsrc","getData","get","then","d","value","data","router","gotoPay","content","totalPrice","cartState","map","i","a","mname","b","c","price","toString","JSON","stringify","replace","post","res","isSuccess","setTimeout","push","path","state","ono","alert","addMenutoCart","amount","Map","set","item","imgurl","responseType","url","URL","createObjectURL","mno","deletefromCart","splice"],"sources":["C:/Users/1/Desktop/vvv/frontend/src/views/GuestMenuView.vue"],"sourcesContent":["<template>\r\n  <div class=\"wrapper\">\r\n    <div>\r\n      <div class=\"loading-progress\" v-if=\"isWaitingtoPay\">\r\n        <v-progress-circular :size=\"74\" :width=\"8\" indeterminate></v-progress-circular>\r\n      </div>\r\n      <v-card variant=\"flat\">\r\n        <MenuListBody :imgsrc=\"imgsrc\" :isLoading=\"isLoading\" :myData=\"myData\" @add-to-cart=\"addMenutoCart\"></MenuListBody>\r\n        <MenuListFooter @go-to-pay=\"gotoPay\" @delete-from-cart=\"deletefromCart\" :myCart=\"myCart\"></MenuListFooter>\r\n      </v-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted } from 'vue';\r\nimport axios from 'axios';\r\nimport { ref } from \"vue\";\r\nimport MenuListBody from '@/components/MenuListBody.vue'\r\nimport MenuListFooter from '@/components/MenuListFooter.vue'\r\nimport { useRouter } from 'vue-router';\r\n\r\n\r\nlet myData = ref([]);\r\nlet isLoading = ref(true);\r\nlet myCart = ref([]);\r\nlet isWaitingtoPay = ref(false);\r\n\r\nlet imgsrc = ref({});\r\nasync function getData() {\r\n  await axios.get(\"/api/menu/list\").then((d) => {\r\n    myData.value = d.data;\r\n  })\r\n}\r\nconst router = useRouter();\r\n\r\nfunction gotoPay() {\r\n  isWaitingtoPay.value = true;\r\n  let content = {};\r\n  let totalPrice = 0;\r\n  let cartState = myCart.value.map(i => {\r\n    let a = i.get('menu').mname;\r\n    let b = i.get('amount');\r\n    let c = i.get('menu').price * b;\r\n    content[a] = b.toString() + \"개\";\r\n    totalPrice += c;\r\n    return [a, b, c];\r\n  });\r\n\r\n\r\n  const data = {\r\n    'content': JSON.stringify(content).replace(/['\"]+/g, ''),\r\n    'totalPrice': totalPrice,\r\n  }\r\n\r\n\r\n\r\n  axios.post('/api/order', data\r\n\r\n  ).then((res) => {\r\n    if (res.data.isSuccess) {\r\n      setTimeout(() => {\r\n        isWaitingtoPay.value = false;\r\n        router.push({\r\n          path: '/result', name: 'result', state: {\r\n            ono: res.data.ono,\r\n            myCart: cartState,\r\n          }\r\n        });\r\n      }, 1000\r\n      );\r\n    } else {\r\n      alert('오류: 주문 접수 실패');\r\n      isWaitingtoPay.value = false;\r\n    }\r\n\r\n  })\r\n}\r\n\r\n\r\nfunction addMenutoCart(i, amount) {\r\n  let map = new Map();\r\n  map.set('menu', i);\r\n  map.set('amount', amount);\r\n  myCart.value.push(map);\r\n}\r\n\r\nonMounted(async () => {\r\n  await getData().then(async ()=>{\r\n    for(let item of myData.value) {\r\n      await axios.get(\"/api/menu_img/\" + item.imgurl , {responseType: 'blob'}).then((a) => {\r\n          let url = URL.createObjectURL(a.data);\r\n          imgsrc.value[item.mno] = url;\r\n      });\r\n    }\r\n  }\r\n  )\r\n  isLoading.value = false;\r\n  \r\n  \r\n});\r\n\r\n\r\nfunction deletefromCart(i) {\r\n  myCart.value.splice(i, 1);\r\n}\r\n\r\n\r\n\r\n</script>\r\n\r\n<script>\r\nexport default {\r\n  name: 'GuestMenuView',\r\n  props: {\r\n\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n.loading-progress {\r\n  position: absolute;\r\n  z-index: 1;\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 768px;\r\n  /* top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%); */\r\n\r\n}\r\n\r\n.wrapper {\r\n  width: 768px;\r\n}\r\n\r\n@media screen and (max-width: 767px) {\r\n  .wrapper {\r\n    width: 100vw;\r\n  }\r\n\r\n  .loading-progress {\r\n    width: 100vw;\r\n}\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}