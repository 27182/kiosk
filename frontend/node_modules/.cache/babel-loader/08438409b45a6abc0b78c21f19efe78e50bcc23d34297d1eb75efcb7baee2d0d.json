{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { unref as _unref, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-4bf23c06\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"wrapper\"\n};\nconst _hoisted_2 = [\"src\"];\nconst _hoisted_3 = {\n  class: \"notice\"\n};\nimport axios from 'axios';\n// import { computed } from 'vue';\n// import { watch } from 'vue';\nimport { onMounted } from 'vue';\nimport { ref } from 'vue';\nimport { useRouter } from 'vue-router';\nconst __default__ = {\n  name: 'PaymentView'\n};\nexport default /*#__PURE__*/Object.assign(__default__, {\n  setup(__props) {\n    let kakaoLink = ref(\"\");\n    let myCart = ref([]);\n    let orderData = ref({});\n\n    // let frame = ref(null);\n\n    // let frame_href = ref(\"\");\n\n    onMounted(() => {\n      if (history.state.myCart != null) {\n        myCart.value = history.state.myCart;\n      }\n      orderData.value = history.state.orderData;\n\n      // console.log(frame.value);\n\n      getReadytoPay();\n    });\n\n    // computed(()=>{\n    //     frame_href.value = frame.value.contentWindow.location.href;\n    // })\n\n    // watch(frame_href,()=>{\n    //     try{\n    //         frame_href.value = frame.value.contentWindow.location.href;\n    //         if(frame_href.value.indexOf(\"pg_token\") !== -1){\n    //             alert('!!')\n    //         }\n    //         console.log(frame_href.value)\n    //     } catch(e){\n    //         console.log(e);\n    //     }\n    // })\n\n    const router = useRouter();\n    window.addEventListener('message', function (e) {\n      if (e.data.isSuccess === 'false') {\n        router.push({\n          path: '/result',\n          name: 'result',\n          state: {\n            myCart: myCart\n          }\n        });\n      }\n    });\n    function getReadytoPay() {\n      axios.post('/api/kakaopay/ready', orderData.value).then(res => {\n        kakaoLink.value = res.data.next_redirect_pc_url;\n      });\n    }\n    return (_ctx, _cache) => {\n      const _component_v_btn = _resolveComponent(\"v-btn\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"iframe\", {\n        ref: \"frame\",\n        class: \"pay-frame\",\n        src: _unref(kakaoLink)\n      }, \"\\r\\n\\r\\n        \", 8, _hoisted_2), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"h4\", null, [_createTextVNode(\" 테스트용 키로 구현하여 결제하여도 실제 돈은 빠져나가지 않습니다. \"), _createVNode(_component_v_btn, {\n        text: \"결제 스킵하기\",\n        color: \"red\"\n      })])])]);\n    };\n  }\n});","map":{"version":3,"names":["axios","onMounted","ref","useRouter","__default__","name","kakaoLink","myCart","orderData","history","state","value","getReadytoPay","router","window","addEventListener","e","data","isSuccess","push","path","post","then","res","next_redirect_pc_url"],"sources":["C:/Users/201-14/Desktop/vvvvvvvvvvvvvvvvv/frontend/src/views/PaymentView.vue"],"sourcesContent":["<template>\r\n    <div class=\"wrapper\">\r\n\r\n        <iframe ref=\"frame\" class=\"pay-frame\" :src=\"kakaoLink\">\r\n\r\n        </iframe>\r\n        <div class=\"notice\">\r\n            <h4>\r\n                테스트용 키로 구현하여 결제하여도 실제 돈은 빠져나가지 않습니다.\r\n                <v-btn text=\"결제 스킵하기\" color=\"red\">\r\n\r\n                </v-btn>\r\n            </h4>\r\n        </div>\r\n\r\n\r\n\r\n    </div>\r\n</template>\r\n\r\n\r\n\r\n<script setup>\r\nimport axios from 'axios';\r\n// import { computed } from 'vue';\r\n// import { watch } from 'vue';\r\nimport { onMounted } from 'vue';\r\nimport { ref } from 'vue'\r\nimport { useRouter } from 'vue-router';\r\n\r\nlet kakaoLink = ref(\"\");\r\n\r\nlet myCart = ref([]);\r\n\r\nlet orderData = ref({});\r\n\r\n// let frame = ref(null);\r\n\r\n// let frame_href = ref(\"\");\r\n\r\n\r\nonMounted(() => {\r\n    if (history.state.myCart != null) {\r\n        myCart.value = history.state.myCart;\r\n    }\r\n\r\n    orderData.value = history.state.orderData;\r\n\r\n    // console.log(frame.value);\r\n\r\n    getReadytoPay();\r\n\r\n})\r\n\r\n// computed(()=>{\r\n//     frame_href.value = frame.value.contentWindow.location.href;\r\n// })\r\n\r\n\r\n\r\n// watch(frame_href,()=>{\r\n//     try{\r\n//         frame_href.value = frame.value.contentWindow.location.href;\r\n//         if(frame_href.value.indexOf(\"pg_token\") !== -1){\r\n//             alert('!!')\r\n//         }\r\n//         console.log(frame_href.value)\r\n//     } catch(e){\r\n//         console.log(e);\r\n//     }\r\n// })\r\n\r\nconst router = useRouter();\r\nwindow.addEventListener('message', function(e) {\r\n    if(e.data.isSuccess === 'false'){\r\n        router.push({\r\n           path: '/result', name: 'result', state: {\r\n             myCart: myCart,\r\n          }\r\n        });\r\n    }\r\n})\r\n\r\n\r\nfunction getReadytoPay() {\r\n    axios.post('/api/kakaopay/ready', orderData.value).then((res) => {\r\n        kakaoLink.value = res.data.next_redirect_pc_url;\r\n    })\r\n}\r\n\r\n\r\n</script>\r\n\r\n\r\n<script>\r\n\r\nexport default {\r\n    name: 'PaymentView'\r\n}\r\n\r\n\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.wrapper {\r\n    height: 100vh;\r\n    width: 35em;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n}\r\n\r\n.notice {\r\n    color: red;\r\n}\r\n\r\n.pay-frame {\r\n    width: 100%;\r\n    height: 80%;\r\n    border: none;\r\n    border-radius: 25px;\r\n}\r\n</style>"],"mappings":";;;;;;;;;;AAuBA,OAAOA,KAAK,MAAM,OAAO;AACzB;AACA;AACA,SAASC,SAAS,QAAQ,KAAK;AAC/B,SAASC,GAAG,QAAQ,KAAK;AACzB,SAASC,SAAS,QAAQ,YAAY;AAoEtC,MAAAC,WAAA,GAAe;EACXC,IAAI,EAAE;AACV,CAAC;;;IApED,IAAIC,SAAS,GAAGJ,GAAG,CAAC,EAAE,CAAC;IAEvB,IAAIK,MAAM,GAAGL,GAAG,CAAC,EAAE,CAAC;IAEpB,IAAIM,SAAS,GAAGN,GAAG,CAAC,CAAC,CAAC,CAAC;;IAEvB;;IAEA;;IAGAD,SAAS,CAAC,MAAM;MACZ,IAAIQ,OAAO,CAACC,KAAK,CAACH,MAAM,IAAI,IAAI,EAAE;QAC9BA,MAAM,CAACI,KAAK,GAAGF,OAAO,CAACC,KAAK,CAACH,MAAM;MACvC;MAEAC,SAAS,CAACG,KAAK,GAAGF,OAAO,CAACC,KAAK,CAACF,SAAS;;MAEzC;;MAEAI,aAAa,CAAC,CAAC;IAEnB,CAAC,CAAC;;IAEF;IACA;IACA;;IAIA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA,MAAMC,MAAM,GAAGV,SAAS,CAAC,CAAC;IAC1BW,MAAM,CAACC,gBAAgB,CAAC,SAAS,EAAE,UAASC,CAAC,EAAE;MAC3C,IAAGA,CAAC,CAACC,IAAI,CAACC,SAAS,KAAK,OAAO,EAAC;QAC5BL,MAAM,CAACM,IAAI,CAAC;UACTC,IAAI,EAAE,SAAS;UAAEf,IAAI,EAAE,QAAQ;UAAEK,KAAK,EAAE;YACtCH,MAAM,EAAEA;UACX;QACF,CAAC,CAAC;MACN;IACJ,CAAC,CAAC;IAGF,SAASK,aAAaA,CAAA,EAAG;MACrBZ,KAAK,CAACqB,IAAI,CAAC,qBAAqB,EAAEb,SAAS,CAACG,KAAK,CAAC,CAACW,IAAI,CAAEC,GAAG,IAAK;QAC7DjB,SAAS,CAACK,KAAK,GAAGY,GAAG,CAACN,IAAI,CAACO,oBAAoB;MACnD,CAAC,CAAC;IACN"},"metadata":{},"sourceType":"module","externalDependencies":[]}