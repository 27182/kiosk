{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-1123d0d2\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"wrapper\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"loading-progress\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_progress_circular = _resolveComponent(\"v-progress-circular\");\n  const _component_v_card = _resolveComponent(\"v-card\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", null, [$setup.isWaitingtoPay ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createVNode(_component_v_progress_circular, {\n    size: 74,\n    width: 8,\n    indeterminate: \"\"\n  })])) : _createCommentVNode(\"v-if\", true), _createVNode(_component_v_card, {\n    variant: \"flat\"\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"MenuListBody\"], {\n      base64_image: $setup.base64_image,\n      isLoading: $setup.isLoading,\n      myData: $setup.myData,\n      onAddToCart: $setup.addMenutoCart\n    }, null, 8 /* PROPS */, [\"base64_image\", \"isLoading\", \"myData\"]), _createVNode($setup[\"MenuListFooter\"], {\n      onGoToPay: $setup.gotoPay,\n      onDeleteFromCart: $setup.deletefromCart,\n      myCart: $setup.myCart\n    }, null, 8 /* PROPS */, [\"myCart\"])]),\n    _: 1 /* STABLE */\n  })])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","$setup","isWaitingtoPay","_hoisted_2","_createVNode","_component_v_progress_circular","size","width","indeterminate","_component_v_card","variant","base64_image","isLoading","myData","onAddToCart","addMenutoCart","onGoToPay","gotoPay","onDeleteFromCart","deletefromCart","myCart"],"sources":["C:\\Users\\201-14\\Desktop\\temp\\새 폴더\\my\\frontend\\src\\views\\GuestMenuView.vue"],"sourcesContent":["<template>\r\n  <div class=\"wrapper\">\r\n    <div>\r\n      <div class=\"loading-progress\" v-if=\"isWaitingtoPay\">\r\n        <v-progress-circular :size=\"74\" :width=\"8\" indeterminate></v-progress-circular>\r\n      </div>\r\n      <v-card variant=\"flat\">\r\n        <MenuListBody :base64_image=\"base64_image\" :isLoading=\"isLoading\" :myData=\"myData\" @add-to-cart=\"addMenutoCart\"></MenuListBody>\r\n        <MenuListFooter @go-to-pay=\"gotoPay\" @delete-from-cart=\"deletefromCart\" :myCart=\"myCart\"></MenuListFooter>\r\n      </v-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted } from 'vue';\r\nimport axios from 'axios';\r\nimport { ref } from \"vue\";\r\nimport MenuListBody from '@/components/MenuListBody.vue'\r\nimport MenuListFooter from '@/components/MenuListFooter.vue'\r\nimport { useRouter } from 'vue-router';\r\n\r\n\r\nlet myData = ref([]);\r\nlet isLoading = ref(true);\r\nlet myCart = ref([]);\r\nlet isWaitingtoPay = ref(false);\r\n\r\nlet base64_image = ref({});\r\nasync function getData() {\r\n  await axios.get(\"/api/menu/list\").then((d) => {\r\n    myData.value = d.data;\r\n  })\r\n}\r\nconst router = useRouter();\r\n\r\nfunction gotoPay() {\r\n  isWaitingtoPay.value = true;\r\n  let content = {};\r\n  let totalPrice = 0;\r\n  let cartState = myCart.value.map(i => {\r\n    let a = i.get('menu').mname;\r\n    let b = i.get('amount');\r\n    let c = i.get('menu').price * b;\r\n    content[a] = b.toString() + \"개\";\r\n    totalPrice += c;\r\n    return [a, b, c];\r\n  });\r\n\r\n\r\n  const data = {\r\n    'content': JSON.stringify(content).replace(/['\"]+/g, ''),\r\n    'totalPrice': totalPrice,\r\n  }\r\n\r\n\r\n\r\n  axios.post('/api/order', data\r\n\r\n  ).then((res) => {\r\n    if (res.data.isSuccess) {\r\n      setTimeout(() => {\r\n        isWaitingtoPay.value = false;\r\n        router.push({\r\n          path: '/result', name: 'result', state: {\r\n            ono: res.data.ono,\r\n            myCart: cartState,\r\n          }\r\n        });\r\n      }, 1000\r\n      );\r\n    } else {\r\n      alert('오류: 주문 접수 실패');\r\n      isWaitingtoPay.value = false;\r\n    }\r\n\r\n  })\r\n}\r\n\r\n\r\nfunction addMenutoCart(i, amount) {\r\n  let map = new Map();\r\n  map.set('menu', i);\r\n  map.set('amount', amount);\r\n  myCart.value.push(map);\r\n}\r\n\r\nonMounted(() => {\r\n  getData().then(async ()=>{\r\n    console.log(myData.value)\r\n    for(let item of myData.value) {\r\n      await axios.get(\"/api/menu_img/\" + item.imgurl).then((a) => {\r\n        if (a.status !== 404){\r\n          base64_image.value[item.mno] = a;\r\n        }\r\n      }).catch(() => { });\r\n    }\r\n  }\r\n  ).then(()=>{\r\n    console.log(base64_image.value[\"22\"])\r\n    isLoading.value = false;\r\n  })\r\n  \r\n});\r\n\r\n\r\nfunction deletefromCart(i) {\r\n  myCart.value.splice(i, 1);\r\n}\r\n\r\n\r\n\r\n</script>\r\n\r\n<script>\r\nexport default {\r\n  name: 'GuestMenuView',\r\n  props: {\r\n\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n.loading-progress {\r\n  position: absolute;\r\n  z-index: 1;\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 768px;\r\n  /* top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%); */\r\n\r\n}\r\n</style>\r\n"],"mappings":";;;EACOA,KAAK,EAAC;AAAS;;;EAEXA,KAAK,EAAC;;;;;uBAFfC,mBAAA,CAUM,OAVNC,UAUM,GATJC,mBAAA,CAQM,cAPgCC,MAAA,CAAAC,cAAc,I,cAAlDJ,mBAAA,CAEM,OAFNK,UAEM,GADJC,YAAA,CAA+EC,8BAAA;IAAzDC,IAAI,EAAE,EAAE;IAAGC,KAAK,EAAE,CAAC;IAAEC,aAAa,EAAb;6CAE7CJ,YAAA,CAGSK,iBAAA;IAHDC,OAAO,EAAC;EAAM;sBACpB,MAA+H,CAA/HN,YAAA,CAA+HH,MAAA;MAAhHU,YAAY,EAAEV,MAAA,CAAAU,YAAY;MAAGC,SAAS,EAAEX,MAAA,CAAAW,SAAS;MAAGC,MAAM,EAAEZ,MAAA,CAAAY,MAAM;MAAGC,WAAW,EAAEb,MAAA,CAAAc;sEACjGX,YAAA,CAA0GH,MAAA;MAAzFe,SAAS,EAAEf,MAAA,CAAAgB,OAAO;MAAGC,gBAAgB,EAAEjB,MAAA,CAAAkB,cAAc;MAAGC,MAAM,EAAEnB,MAAA,CAAAmB"},"metadata":{},"sourceType":"module","externalDependencies":[]}