{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-1c79c478\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"wrapper\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"loading-progress\"\n};\nimport { onMounted } from 'vue';\nimport axios from 'axios';\nimport { ref } from \"vue\";\nimport MenuListBody from '@/components/MenuListBody.vue';\nimport MenuListFooter from '@/components/MenuListFooter.vue';\n// import { useRouter } from 'vue-router';\n\nconst __default__ = {\n  name: 'GuestMenuView',\n  props: {}\n};\nexport default /*#__PURE__*/Object.assign(__default__, {\n  setup(__props) {\n    let myData = ref([]);\n    let isLoading = ref(true);\n    let myCart = ref([]);\n    let isWaitingtoPay = ref(false);\n    // let tid = \"\";\n    let isActive = ref(false);\n    let imgsrc = ref({});\n    async function getData() {\n      await axios.get(\"/api/menu/list\").then(d => {\n        myData.value = d.data;\n      });\n    }\n    // const router = useRouter();\n\n    async function gotoPay() {\n      isWaitingtoPay.value = true;\n      let content = {};\n      let totalPrice = 0;\n      let cartState = myCart.value.map(i => {\n        let a = i.get('menu').mname;\n        let b = i.get('amount');\n        let c = i.get('menu').price * b;\n        content[a] = b.toString() + \"개\";\n        totalPrice += c;\n        return [a, b, c];\n      });\n      const data = {\n        'content': JSON.stringify(content).replace(/['\"]+/g, ''),\n        'totalPrice': totalPrice\n      };\n      await axios.post('/api/kakaopay/ready', data).then(res => {\n        if (res.status === 200) {\n          window.open(res.data.next_redirect_pc_url, '_blank', \"width=420,height=500,left=200,top=200\");\n        }\n      });\n\n      // axios.post('/api/order', data\n      //\n      // ).then((res) => {\n      //   if (res.data.isSuccess) {\n      //     setTimeout(() => {\n      //       isWaitingtoPay.value = false;\n      //       router.push({\n      //         path: '/result', name: 'result', state: {\n      //           ono: res.data.ono,\n      //           myCart: cartState,\n      //         }\n      //       });\n      //     }, 1000\n      //     );\n      //   } else {\n      //     alert('오류: 주문 접수 실패');\n      //     isWaitingtoPay.value = false;\n      //   }\n      //\n      // })\n    }\n    function addMenutoCart(i, amount) {\n      let map = new Map();\n      map.set('menu', i);\n      map.set('amount', amount);\n      myCart.value.push(map);\n    }\n    onMounted(async () => {\n      await getData().then(async () => {\n        for (let item of myData.value) {\n          if (item.imgurl.length >= 1) {\n            await axios.get(\"/api/menu_img/\" + item.imgurl, {\n              responseType: 'blob'\n            }).then(a => {\n              let url = URL.createObjectURL(a.data);\n              imgsrc.value[item.mno] = url;\n            });\n          }\n        }\n      });\n      isLoading.value = false;\n    });\n    function deletefromCart(i) {\n      myCart.value.splice(i, 1);\n    }\n    return (_ctx, _cache) => {\n      const _component_v_progress_circular = _resolveComponent(\"v-progress-circular\");\n      const _component_v_card = _resolveComponent(\"v-card\");\n      const _component_v_card_text = _resolveComponent(\"v-card-text\");\n      const _component_v_spacer = _resolveComponent(\"v-spacer\");\n      const _component_v_btn = _resolveComponent(\"v-btn\");\n      const _component_v_card_actions = _resolveComponent(\"v-card-actions\");\n      const _component_v_dialog = _resolveComponent(\"v-dialog\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", null, [_unref(isWaitingtoPay) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createVNode(_component_v_progress_circular, {\n        size: 74,\n        width: 8,\n        indeterminate: \"\"\n      })])) : _createCommentVNode(\"\", true), _createVNode(_component_v_card, {\n        variant: \"flat\"\n      }, {\n        default: _withCtx(() => [_createVNode(MenuListBody, {\n          imgsrc: _unref(imgsrc),\n          isLoading: _unref(isLoading),\n          myData: _unref(myData),\n          onAddToCart: addMenutoCart\n        }, null, 8, [\"imgsrc\", \"isLoading\", \"myData\"]), _createVNode(MenuListFooter, {\n          onGoToPay: gotoPay,\n          onDeleteFromCart: deletefromCart,\n          myCart: _unref(myCart)\n        }, null, 8, [\"myCart\"])]),\n        _: 1\n      })]), _createVNode(_component_v_dialog, {\n        width: \"500\",\n        height: \"500\"\n      }, {\n        default: _withCtx(({\n          isActive\n        }) => [_createVNode(_component_v_card, {\n          title: \"Dialog\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_v_card_text, null, {\n            default: _withCtx(() => [_createTextVNode(\" Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. \")]),\n            _: 1\n          }), _createVNode(_component_v_card_actions, null, {\n            default: _withCtx(() => [_createVNode(_component_v_spacer), _createVNode(_component_v_btn, {\n              text: \"취소\",\n              onClick: $event => isActive.value = false\n            }, null, 8, [\"onClick\"])]),\n            _: 2\n          }, 1024)]),\n          _: 2\n        }, 1024)]),\n        _: 1\n      })]);\n    };\n  }\n});","map":{"version":3,"names":["onMounted","axios","ref","MenuListBody","MenuListFooter","__default__","name","props","myData","isLoading","myCart","isWaitingtoPay","isActive","imgsrc","getData","get","then","d","value","data","gotoPay","content","totalPrice","cartState","map","i","a","mname","b","c","price","toString","JSON","stringify","replace","post","res","status","window","open","next_redirect_pc_url","addMenutoCart","amount","Map","set","push","item","imgurl","length","responseType","url","URL","createObjectURL","mno","deletefromCart","splice"],"sources":["C:/Users/201-14/Desktop/vvvv/frontend/src/views/GuestMenuView.vue"],"sourcesContent":["<template>\r\n  <div class=\"wrapper\">\r\n    <div>\r\n      <div class=\"loading-progress\" v-if=\"isWaitingtoPay\">\r\n        <v-progress-circular :size=\"74\" :width=\"8\" indeterminate></v-progress-circular>\r\n      </div>\r\n      <v-card variant=\"flat\">\r\n        <MenuListBody :imgsrc=\"imgsrc\" :isLoading=\"isLoading\" :myData=\"myData\" @add-to-cart=\"addMenutoCart\">\r\n        </MenuListBody>\r\n        <MenuListFooter @go-to-pay=\"gotoPay\" @delete-from-cart=\"deletefromCart\" :myCart=\"myCart\"></MenuListFooter>\r\n      </v-card>\r\n    </div>\r\n\r\n    <v-dialog width=\"500\" height=\"500\">\r\n\r\n      <template v-slot:default=\"{ isActive }\">\r\n        <v-card title=\"Dialog\">\r\n          <v-card-text>\r\n            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore\r\n            magna aliqua.\r\n          </v-card-text>\r\n\r\n          <v-card-actions>\r\n            <v-spacer></v-spacer>\r\n\r\n            <v-btn text=\"취소\" @click=\"isActive.value = false\"></v-btn>\r\n          </v-card-actions>\r\n        </v-card>\r\n      </template>\r\n    </v-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted } from 'vue';\r\nimport axios from 'axios';\r\nimport { ref } from \"vue\";\r\nimport MenuListBody from '@/components/MenuListBody.vue'\r\nimport MenuListFooter from '@/components/MenuListFooter.vue'\r\n// import { useRouter } from 'vue-router';\r\n\r\n\r\nlet myData = ref([]);\r\nlet isLoading = ref(true);\r\nlet myCart = ref([]);\r\nlet isWaitingtoPay = ref(false);\r\n// let tid = \"\";\r\nlet isActive = ref(false)\r\n\r\nlet imgsrc = ref({});\r\nasync function getData() {\r\n  await axios.get(\"/api/menu/list\").then((d) => {\r\n    myData.value = d.data;\r\n  })\r\n}\r\n// const router = useRouter();\r\n\r\nasync function gotoPay() {\r\n  isWaitingtoPay.value = true;\r\n  let content = {};\r\n  let totalPrice = 0;\r\n  let cartState = myCart.value.map(i => {\r\n    let a = i.get('menu').mname;\r\n    let b = i.get('amount');\r\n    let c = i.get('menu').price * b;\r\n    content[a] = b.toString() + \"개\";\r\n    totalPrice += c;\r\n    return [a, b, c];\r\n  });\r\n\r\n\r\n  const data = {\r\n    'content': JSON.stringify(content).replace(/['\"]+/g, ''),\r\n    'totalPrice': totalPrice,\r\n  }\r\n\r\n\r\n  await axios.post('/api/kakaopay/ready', data).then((res) => {\r\n    if (res.status === 200) {\r\n      window.open(res.data.next_redirect_pc_url, '_blank', \"width=420,height=500,left=200,top=200\");\r\n    }\r\n  });\r\n\r\n\r\n\r\n  // axios.post('/api/order', data\r\n  //\r\n  // ).then((res) => {\r\n  //   if (res.data.isSuccess) {\r\n  //     setTimeout(() => {\r\n  //       isWaitingtoPay.value = false;\r\n  //       router.push({\r\n  //         path: '/result', name: 'result', state: {\r\n  //           ono: res.data.ono,\r\n  //           myCart: cartState,\r\n  //         }\r\n  //       });\r\n  //     }, 1000\r\n  //     );\r\n  //   } else {\r\n  //     alert('오류: 주문 접수 실패');\r\n  //     isWaitingtoPay.value = false;\r\n  //   }\r\n  //\r\n  // })\r\n}\r\n\r\n\r\nfunction addMenutoCart(i, amount) {\r\n  let map = new Map();\r\n  map.set('menu', i);\r\n  map.set('amount', amount);\r\n  myCart.value.push(map);\r\n}\r\n\r\nonMounted(async () => {\r\n  await getData().then(async () => {\r\n    for (let item of myData.value) {\r\n      if (item.imgurl.length >= 1) {\r\n        await axios.get(\"/api/menu_img/\" + item.imgurl, { responseType: 'blob' }).then((a) => {\r\n          let url = URL.createObjectURL(a.data);\r\n          imgsrc.value[item.mno] = url;\r\n        });\r\n      }\r\n    }\r\n  }\r\n  )\r\n  isLoading.value = false;\r\n\r\n\r\n});\r\n\r\n\r\nfunction deletefromCart(i) {\r\n  myCart.value.splice(i, 1);\r\n}\r\n\r\n\r\n\r\n</script>\r\n\r\n<script>\r\nexport default {\r\n  name: 'GuestMenuView',\r\n  props: {\r\n\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n.loading-progress {\r\n  position: absolute;\r\n  z-index: 1;\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 768px;\r\n  /* top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%); */\r\n\r\n}\r\n\r\n.wrapper {\r\n  width: 768px;\r\n}\r\n\r\n@media screen and (max-width: 767px) {\r\n  .wrapper {\r\n    width: 100vw;\r\n  }\r\n\r\n  .loading-progress {\r\n    width: 100vw;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}